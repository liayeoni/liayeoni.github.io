---
title: F-분포와 분산분석
description: 
author: Ahyeon Lee
date: 2024-04-20
categories: [통계학]
tags: [statistics]
pin: true
math: true
mermaid: true
---

## F-분포

f-분포는 정규분포를 이루는 모집단에서 독립적으로 추출한 표본들의 분산비율이 나타내는 연속확률 분포이다.  2개 이상의 표본 평균들이 동일한 모평균을 가진 집단에서 추출되었는지 서로 다른 모집단에서 추출된 것인지를 판단하기 위하여 이용한다.

 
### 예시
예를 들어 두 가지 음식 A, B가 몸무게에 어떤 영향을 주는지 확인하는 조사를 진행한다고 하자.
피험자가 몸무게에 큰 차이가 없는 피험자 집단을 모집하고, 세그룹으로 나눈다음 식이 조절을 시키고, 체중을 비교한다.

각 그룹별 몸무게의 평균과 표준편차를 볼 때 약간의 차이를 보이는 것 같기도 하다.
그렇다면 이 차이는 음식의 영향일까 아니면 다른 이유로 몸무게가 '우연히' 변했기 때문일까?

![](https://velog.velcdn.com/images/liayeoni/post/35d75ec2-fa20-4369-b8e5-17abd31bcfbc/image.png)

## F-값과 ANOVA
t-value와 마찬가지로  F-value도 차이 / 불확실도로 표본 그룹 간 차이를 숫자로 나타낼 수 있다.

위의 예시에서 음식 A, B의 영향이 얼마나 컸는지 확인하기 위해서는 각 그룹 간 몸무게 평균이 얼마나 차이나는지로 확인할 수 있다.

### 총분산의 분해
총분산이란 집단을 구분하지 않고 모든 표본 데이터에서 구한 분산이다.

**총분산 = 집단내 분산+ 집단간 분산**

분산은 **집단 내 분산**과 **집단간 분산**으로 분리될 수 있다. 집단 내 분산은 각 집단을 구성하는 개별 데이터간 변동성을 의미하고, 집단 간 분산은 각 집단끼리의 평균 차이, 변동성을 의미한다.  
결론적으로 집단 간의 분산이 크면 집단 간 평균에 차이가 클 가능성이 커지게 된다.

집단 간 평균에 차이가 난다면, 표면적 이유는 집단이 다르기 때문이다. 집단 내에서의 차이, 변동성은 우연에 의해서 발생한다고 할 수 있다.

예를 들어 집단 간 분산이 2, 집단 내 분산이 10이라고 치자. 
집단이 달라 발생하는 분산이라기 보다는 집단 내에서 ‘우연히’ 발생할 수 있는 분산의 범위 내에 있다고 할 수 있다. 그러므로, 이러한 변동성의 원인이 집단이 다르기 때문이라고 할 수 있는 근거가 부족하다.
반대의 상황에서는 집단 내에서 ‘우연히’ 발생하는 분산 외에 집단 간 차이로 인해 발생하는 분산이 섞여 있으므로 집단 간 차이로 변동성이 발생했다는 논리가 된다. 

그림으로 나타내면 다음과 같다.

![](https://velog.velcdn.com/images/liayeoni/post/0a6b6784-c6d2-4ee4-9c3d-78da9eb18d38/image.png)


위 그림에서 빨간색집단과 파란색 집단은 확연히 다르다는 것을 알 수 있다. 집단 내 분산보다는 집단간 분산이 더 크다.

![](https://velog.velcdn.com/images/liayeoni/post/ebb6690f-f1b8-49df-9ff2-75a4a5533dea/image.png)


두 번째 그림에서는 빨간색 집단과 파란색 집단의 분포가 약간 겹친다. 상대적으로 집단 내 분산의 크기가 더 커지고, 집단간 분산은 작아졌다.

![](https://velog.velcdn.com/images/liayeoni/post/ff31b766-e101-42cc-a134-d748bb1920b9/image.png)


마지막 그림에서는 집단 간 겹치는 부분이 커졌고, 집단 간 분산보다 집단 내 분산이 더 커졌다. 집단 내 분산이 많이 커졌을 때에는 두 표본의 평균이 모집단에서도 차이가 날지, 표본에서만 차이가 나는 건지 확신할 수 없게 된다. 그러므로 두 집단의 평균은 같다는 귀무가설을 기각하기 힘들어진다.

> 세 집단의 비교에서 한 집단의 평균이 나머지와 다른경우, 집단 간 분산이 크기 때문에 하나 이상의 집단이 다른 집단과 많이 떨어져 있다는 것은 알 수 있지만, 구체적으로 어떤 집단이 어떻게 다른지는 분산 분석 값 자체로는 알 수 없다.

### 예시 
자세한 예시를 들어보면 다음과 같다.

핸드폰을 평소에 많이 사용하지 않는 그룹과 많이 사용하는 두 그룹에 대해 F-value를 계산해본다고 하자.
핸드폰 사용량이 적은 그룹에서는 평균 49%, 사용량이 많은 그룹에서는 평균 41%로 확인되었으며, 각 그룹의 표준 편차는 21%, 22%로 확인되었다고 한다.

![](https://velog.velcdn.com/images/liayeoni/post/d81ae090-6ca8-4036-85e6-1cdff8bc07d5/image.png)

그룹 내 분산을 계산해보면 다음과 같다.

$$s^2_{wit} = \frac{1}{2}\left(s^2_{low}+s^2_{high}\right)$$
= $$\frac{1}{2}\left(21^2+22^2\right)$ = $462.5\%$$

그룹 간 분산은 표준오차의 값을 계산한 후 구할 수 있다.

전체 데이터의 평균값은 

$$\bar{X} = \frac{1}{2}\left(\bar{X}_{low}+\bar{X}_{high}\right) = \frac{1}{2}(49+41) = 45\%$$이고,

$$s_{\bar{X}}$$ 값은 
$$s_{\bar{X}} = \sqrt{\frac{(\bar{X}_{low}-\bar{X})^2+(\bar{X}_{high}-\bar{X})^2}{m-1}}$$
= $$\sqrt{\frac{(49-45)^2+(41-45)^2}{2-1}} = 5.66\%$$

여기서 각 그룹의 샘플 사이즈는 $n =$ 61이므로,

$$s^2_{bet} = s^2_{\bar{X}} = 61(5.66^2) = 1952\%$$

따라서, F-value는 다음과 같이 계산할 수 있다.

$F =$ $$\frac{집단 간 분산} {집단 내 분산}$$

$F$ = $$\frac{s^2_{bet}}{s^2_{wit}} = \frac{1952}{462.5} = 4.22$$

### 통계적 유의성

F값은 1보다 작거나 1보다 크더라도 작은 숫자일 것이고, 이런 작은 값들은 F분포 상에서는 발생할 확률이 아주 클 것이다. 반대로 F값이 큰 값이 나왔다면, F분포 상에서는 그 확률이 매우 적을 것이고, 희박한 확률이기 때문에 모집단에서 평균이 같다는 가정을 기각해야 할 것이다.

충분히 큰 F-value는 보통 상위 5% 혹은 1% 등의 값으로 통상적으로 결정한다.

## f분포표
 F분포는 두 집단의 분산을 다루기 때문에 자유도가 2개가 있는데, 표의 x축은 분자의 자유도를 다루고 있고, y축은 분모의 자유도를 다루고 있다. F분포는 보통 분산이 더 큰 집단을 분자에 놓고, 상대적으로 분산이 작은 집단을 분모에 놓는다.

#### 예시
두 집단 A와 B가 있는데, 집단 A의 표본분산은 20이고, n=9라고 한다. 그리고 집단 B의 표본분산은 30이며, n=6이라고 한다. 이 때 a=0.1에 해당되는 F값을 구하시오.

![](https://velog.velcdn.com/images/liayeoni/post/8fcb1936-0620-4a76-8666-bc8e327f4040/image.png)

F값이 2.73보다 크면 귀무가설을 기각한다.

참고노트

https://diseny.tistory.com/entry/%EB%B6%84%EC%82%B0%EC%9C%BC%EB%A1%9C-%ED%8F%89%EA%B7%A0%EC%B0%A8%EC%9D%B4-%EA%B0%90%EC%A7%80%ED%95%98%EA%B8%B0

https://angeloyeo.github.io/2020/02/29/ANOVA.html
